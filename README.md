# 세탁기 알림 프로젝트
## 프로젝트 설명
세탁기의 현재 상태를 확인하며, 세탁이 완료되면 여러 디바이스들에게 알림을 보내는 프로젝트입니다.  
세탁기를 돌렸는데 다 완료된 상태로 세탁물을 방치하면 악취가 발생합니다. 해당 경험이 불편하여 세탁이 완료되면 근처에 있는 디바이스를 통해 알림을 받을 수 있으면 좋겠다는 생각으로 프로젝트를 계획하였습니다. 완료알림 뿐만 아니라 세탁완료까지 남은 시간도 확인 할 수 있습니다.



## 구조
![프로젝트 구조 이미지]()  
1. 세탁기에 부착하는 ESP32, 여러 센서들도 같이 부착하여 세탁기의 상태를 확인 후 서버에 전송한다
2. 서버역할을 하는 라즈베리파이4
3. 알림을 받을 클라이언트 ex) 핸드폰, 웹, 다른 ESP32(스피커, OLED연결)
 


### 라즈베리파이4를 서버로 사용한 이유  
![ESP32하나에 여러개의 Client 연결된 예시 이미지]()  

서버를 1번 ESP32로 클라이언트를 3번 항목들로 해도 작동은 할 것 같지만  알림을 받을 클라이언트가 늘어날 수록 서버의 부담도 늘어날거라 생각했습니다. ESP32의 성능이 어느정도인지 몰라서 중간 서버를 두어 해당 서버와만 통신을 함으로서 1번 ESP32의 부담을 줄일 수 있을거라 생각했습니다. 그래서 중간서버를 두기로 하였고 지금 가지고 있는 기기가 ESP32, 라즈베리파이4, 노트북, 핸드폰 4가지이므로 그중에서 고르기로 하였습니다. 노트북과 핸드폰은 들고다닐일이 있으므로 24시간 계속 켜둘 서버로서 적절하지않아 제외하였고 ESP32 성능문제가 걱정되니 제외, 적당히 성능이 좋다고 알고있는 라즈베리파이4를 중간서버기기로 선정하였습니다. 


## 구현 기능

|ESP32 기능|기능 상세 설명|
|--|--|
|세탁기 상태정보 전송|남은 세탁시간, 세탁완료했는지 등의 정보를 서버에 보낸다|
|남은 세탁 시간 확인|세탁기의 LED위치를 카메라로 촬영하여 세탁 시간 및 상태를 추출한다. OCR방식대신 특정 픽셀 위치가 켜져 있는지 여부를 확인한다.세탁기는 7-segment LED를 사용함으로, 세그먼트의 조합을 분석하여 표시된 숫자나 문자를 인식할 수 있다.|
|세탁완료 알람|세탁완료 시 알람을 울리라고 서버에 메시지를 보낸다. 그리고 해당 메시지를 수신한 모든 클라이언트들은 계속 알람이 울린다. ESP32에 연결된 버튼을 누르면 서버에 알람중지 메시지를 보낸다.|


|라즈베리파이 기능|기능 상세 설명|
|--|--|
|ESP32->Client 메시지전달|ESP32의 메시지를 Client가 해석할 수 있는 프로토콜로 변환하여 전송한다|
|Client->ESP32 메시지전달|Client의 메시지를 ESP32가 해석할 수 있는 프로토콜로 변환하여 전송한다|



|알림수신 클라이언트 기능|기능 상세 설명|
|--|--|
|세탁기 상태정보 표시|받은 세탁기의 세탁정보를 화면에 표시한다|
|세탁완료시 알람|세탁완료 메시지를 수신하면 알람중지 메시지가 오기전까지 계속 알람을 울린다|


## 세부 기술

|ESP32|<-통신기술+데이터양식->|RasberryPi 4|<-통신기술+데이터양식->|ESP32 etc|
|---|---|---|---|---|
|Arduino C/C++|TCP+JSON|Node.js<br>SQLite3|TCP+JSON<br>(가능한 장치 통신 프로토콜)+JSON|Arduino C/C++<br>(장치가 지원하는 언어로 개발)|

- 모든 전송 데이터는 JSON 포맷을 사용하며, 전송데이터는 모두 문자열(String) 타입으로  통일한다.
- ESP32는 Arduino IDE를 활용하여 C/C++ 기반으로 개발한다.
- 추가 장치가 연결될 경우, 해당 장치에 지원하는 언어 및 IDE를 동일한 방식으로 기술한다.

#### 상세문서
[JSON_SPEC](./docs/json_spec.md), [DB_SCHEMA](./docs/db_schema.md)
## 구현 영상
## 성능 테스트
성능을 어떤 기준으로???
#### 상세문서  
[성능테스트](./docs/db_schema.md)  
## 추후 구현할 기능
SmartThings 적용  
MQTT 허브 적용  
로그 관리페이지  
아직 남아있는 세탁물이 있는지 체크하는 기능 (무게 체크, 이미지로 체크)  
세탁완료 자동문열림  
보안 강화??  

---
## 후기
구현 어려웠던점  
어떻게 극복했는가  